>>> uv run lab1/task2.py
/home/a8c3b742-5df0-8324-baef/local-college/ai/lab1/task2.py:18: VisibleDeprecationWarning: dtype(): align should be passed as Python or NumPy boolean but got `align=0`. Did you mean to pass a tuple to create a subarray type? (Deprecated NumPy 2.4)
  batch = pickle.load(f, encoding="bytes")

Distance Metric: Euclidean
K=1, Accuracy=0.2630
K=3, Accuracy=0.2625
K=5, Accuracy=0.2685
K=7, Accuracy=0.2845
K=9, Accuracy=0.2770

Distance Metric: Manhattan
K=1, Accuracy=0.2835
K=3, Accuracy=0.2740
K=5, Accuracy=0.2950
K=7, Accuracy=0.3085
K=9, Accuracy=0.2995

Distance Metric: Minkowski
K=1, Accuracy=0.2335
K=3, Accuracy=0.2365
K=5, Accuracy=0.2555
K=7, Accuracy=0.2565
K=9, Accuracy=0.2525

Distance Metric: Cosine
K=1, Accuracy=0.2855
K=3, Accuracy=0.2605
K=5, Accuracy=0.2755
K=7, Accuracy=0.2870
K=9, Accuracy=0.2870

Distance Metric: Hamming
K=1, Accuracy=0.2180
K=3, Accuracy=0.2070
K=5, Accuracy=0.2340
K=7, Accuracy=0.2395
K=9, Accuracy=0.2430

Best Model
----------
K = 7
Distance = Manhattan
Accuracy = 0.3085

Confusion Matrix:
[[107   2  19   3  10   1   6   2  44   1]
 [ 20  28  31  11  34   5  17   2  58  11]
 [ 37   0  86   6  59   4  15   0  15   1]
 [ 17   3  47  36  38   8  19   3  16   2]
 [ 12   0  70   5  91   2  17   6  11   0]
 [ 13   0  50  28  31  35  21   0  10   1]
 [  6   2  66   8  63   5  37   4  11   1]
 [ 20   2  37  13  50   5  19  31  19   4]
 [ 29   3   7   3   4   2   0   2 137   2]
 [ 25  12  21   6  16   6   7  10  49  29]]
Precision (macro): 0.3801
Recall (macro): 0.3087